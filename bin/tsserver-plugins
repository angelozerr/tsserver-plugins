#!/usr/bin/env node

var fs = require("fs"),
	vm = require("vm"),
	mod = require('module')

var typescriptDir = process.argv.indexOf("--typescriptDir");
if (typescriptDir > -1) {
  typescriptDir = process.argv[typescriptDir + 1] + '/lib/';
}

// concat 'before-tsserver.js' with 'tsserver.js'
var src = fs.readFileSync(__dirname  + '/../src/before-tsserver.js');
src += '\n';
src += fs.readFileSync(typescriptDir  + 'tsserver.js');

vm.runInThisContext(mod.wrap(src))(exports, require, module, __filename, typescriptDir);